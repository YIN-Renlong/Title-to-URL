<div>
<div>
    <form id="input-form">
        <label for="link">Link address:</label>
        <input type="text" id="link" name="link"><br>

        <label for="title">Article title:</label>
        <input type="text" id="title" name="title"><br>

        <input type="radio" id="useDate" name="option" value="date" checked>
        <label for="useDate">Use Date</label><br>
        <label for="month">Month:</label>
        <select id="month" name="month">
            <option value="01">January</option>
            <option value="02">February</option>
            <option value="03">March</option>
            <option value="04">April</option>
            <option value="05">May</option>
            <option value="06">June</option>
            <option value="07">July</option>
            <option value="08">August</option>
            <option value="09">September</option>
            <option value="10">October</option>
            <option value="11">November</option>
            <option value="12">December</option>
        </select><br>

        <label for="day">Day:</label>
        <select id="day" name="day">
            {% for day in (1..31) %}
                <option value="{{ day | prepend: '0' | slice: -2 }}">{{ day }}</option>
            {% endfor %}
        </select><br>

        <input type="radio" id="useSubdirectory" name="option" value="subdirectory">
        <label for="useSubdirectory">Use Subdirectory</label><br>
        <label for="subdirectory">Subdirectory:</label>
        <input type="text" id="subdirectory" name="subdirectory" disabled><br>

        <input type="submit" value="Generate URL">
    </form>

    <div id="result"></div>

    <script>
    const form = document.getElementById('input-form');
    const resultDiv = document.getElementById('result');
    const useDate = document.getElementById('useDate');
    const useSubdirectory = document.getElementById('useSubdirectory');
    const subdirectoryInput = document.getElementById('subdirectory');

    useDate.addEventListener('change', () => {
        subdirectoryInput.disabled = true;
    });

    useSubdirectory.addEventListener('change', () => {
        subdirectoryInput.disabled = false;
    });

    form.addEventListener('submit', (event) => {
        event.preventDefault();

        const link = form.link.value.trim();
        const title = form.title.value.trim();
        const month = form.month.value;
        const day = form.day.value;
        const year = (new Date()).getFullYear();
        const subdirectory = form.subdirectory.value.trim();
        const selectedOption = document.querySelector('input[name="option"]:checked').value;

        const url = normalizeUrl(title, year, month, day, subdirectory, selectedOption);

        resultDiv.innerHTML = `<p>Your URL is:</p><p><a href="${url}">${url}</a></p>`;
    });

    function normalizeUrl(title, year, month, day, subdirectory, selectedOption) {
        // Replace any non-alphanumeric characters with a hyphen, except for apostrophes
        title = title.replace(/[^\w\s']+/g, '-');
        // Replace apostrophes with an empty string
        title = title.replace(/'/g, '');
        // Replace whitespace with a hyphen
        title = title.replace(/\s+/g, '-');
        // Remove any consecutive hyphens
        title = title.replace(/--+/g, '-');
        // Remove any leading or trailing hyphens
        title = title.replace(/^-|-$/g, '');
        // Convert the title to lowercase
        title = title.toLowerCase();

        // Construct the URL based on the selected option
        let url;
        if (selectedOption === 'date') {
            url = `https://www.website.com/${year}/${month}/${day}/${title}/`;
        } else {
            url = `https://www.website.com/${subdirectory}/${title}/`;
        }

        return url;
    }
</script>

</div>
